<!-- Plugin Configuration File: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- Unique identifier of the plugin. It should be FQN, cannot be changed between the plugin versions. -->
    <id>com.sakura-sedaia.BlenderDevelopment</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/best-practices-for-listing.html#plugin-name -->
    <name>Blender Development</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor url="https://www.sakura-sedaia.com">Sakura Sedaia</vendor>

    <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/best-practices-for-listing.html#plugin-description -->
    <description><![CDATA[
        <h1>Blender Development for PyCharm</h1>
        <p>Integrate Blender extension development directly into your PyCharm workflow. This plugin provides a comprehensive suite of tools to streamline the creation, testing, and deployment of Blender extensions.</p>

        <h3>Core Features:</h3>
        <ul>
            <li><b>Automated Environment Management:</b> Automatically download and manage multiple Blender versions (4.2+ and 5.0) directly from the IDE.</li>
            <li><b>Sandboxed Development:</b> Launch Blender in an isolated development environment with project-local configuration and script directories to prevent conflicts with your main Blender installation.</li>
            <li><b>Real-time Hot-Reloading:</b> Automatically reload your extension in Blender upon saving files in PyCharm, or trigger reloads manually with <code>Ctrl+Alt+R</code>.</li>
            <li><b>Smart Project Templates:</b> Quickly bootstrap new Blender extensions with pre-configured project structures, including optional "auto-load" logic and automated run configurations.</li>
            <li><b>Integrated CLI Tools:</b> Dedicated run configurations for building and validating extensions using the <code>blender --command</code> interface.</li>
            <li><b>Customization:</b> Support for custom Blender splash screens in sandboxed sessions and flexible configuration of executable paths and symlink names.</li>
        </ul>

        <p>Based on the <a href="https://github.com/JacquesLucke/blender_vscode">Blender Development extension for Visual Studio Code</a> by <b>Jacques Lucke</b> and adapted for use in PyCharm.</p>

        <p><i>The Blender Logo is a registered trademark of the Blender Foundation, and is only used in this project to denote functions which directly relate to developing, maintaining, and creation Blender Extensions</i></p>
    ]]></description>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.python</depends>
    <depends>com.intellij.modules.pycharm</depends>

    <!-- Extensions defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <projectConfigurable
                instance="com.sakurasedaia.blenderextensions.settings.BlenderConfigurable"
                id="com.sakurasedaia.blenderextensions.settings.BlenderConfigurable"
                displayName="Blender Extension Integration"/>

        <configurationType implementation="com.sakurasedaia.blenderextensions.run.BlenderRunConfigurationType"/>
        <defaultLiveTemplates file="liveTemplates/Blender.xml"/>

        <directoryProjectGenerator implementation="com.sakurasedaia.blenderextensions.project.BlenderAddonProjectGenerator"/>
        <iconProvider implementation="com.sakurasedaia.blenderextensions.icons.BlenderIconProvider"/>
        
        <toolWindow id="MBVS"
                    anchor="right" 
                    factoryClass="com.sakurasedaia.blenderextensions.ui.BlenderToolWindowFactory" 
                    icon="com.sakurasedaia.blenderextensions.icons.BlenderIcons.Blender"/>

        <fileTemplateGroup implementation="com.sakurasedaia.blenderextensions.actions.BlenderTemplateGroupFactory"/>
    </extensions>

    <actions>
        <group id="BlenderExtensions.Menu" text="Blender" description="Blender extension integration"
               icon="com.sakurasedaia.blenderextensions.icons.BlenderIcons.Blender">
            <add-to-group group-id="MainMenu" anchor="last"/>
            <action id="com.sakurasedaia.blenderextensions.actions.ReloadExtensionAction"
                    class="com.sakurasedaia.blenderextensions.actions.ReloadExtensionAction"
                    text="Reload Extension"
                    description="Reload Blender extension manually">
                <keyboard-shortcut keymap="$default" first-keystroke="control alt R"/>
            </action>
            <action id="com.sakurasedaia.blenderextensions.actions.MarkAsBlenderSourceAction"
                    class="com.sakurasedaia.blenderextensions.actions.MarkAsBlenderSourceAction"
                    text="Mark as Blender Source"
                    description="Designate this folder as a Blender extension source folder">
                <add-to-group group-id="ProjectViewPopupMenu" anchor="after" relative-to-action="MarkRootGroup"/>
            </action>
        </group>

        <action id="com.sakurasedaia.blenderextensions.actions.CreateBlenderFileAction"
                class="com.sakurasedaia.blenderextensions.actions.CreateBlenderFileAction"
                text="Blender File"
                description="Create a new Blender Python file (Add-on or Module)"
                icon="com.sakurasedaia.blenderextensions.icons.BlenderIcons.Blender">
            <add-to-group group-id="NewGroup" anchor="after" relative-to-action="NewFile"/>
        </action>
    </actions>

    <applicationListeners>
        <listener class="com.sakurasedaia.blenderextensions.listeners.BlenderFileSaveListener"
                  topic="com.intellij.openapi.fileEditor.FileDocumentManagerListener"/>
    </applicationListeners>
</idea-plugin>